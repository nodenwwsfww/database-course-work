# Report on the Grand Theft Auto Five Role Play Server Database Model

## Completed: Roman Radchenko
## Date: 2024

### Contents
1. Business Description
   - Business Background
   - Problems and Current Situation
   - Benefits of Implementing a Database
2. Model Descriptions
   - OLTP Database
   - OLAP Database
3. Data Preparation for OLTP Database
4. Script for Loading Data from CSV to OLTP Database
   - Business Background
   - Data Loading Process
   - Business Checks
5. Script for Loading Data from OLTP to OLAP Database
   - Business Background
   - Data Loading Process
6. Power BI Report
7. How to Run the Project

---

## 1. Business Description

### Business Background
The Grand Theft Auto Five Role Play (GTA V RP) server is an immersive online environment where players assume the roles of characters in the GTA V universe. Our server hosts a variety of activities, including character interactions, property management, and job assignments, providing a rich and engaging experience for our users.

### Problems and Current Situation
1. **Unstructured Data**: The current data setup is unstructured, making it difficult to search for specific information.
2. **Data Integrity Issues**: Incorrect data from external sources leads to irrelevant information and bugs.

### Benefits of Implementing a Database
Implementing a comprehensive database system for the GTA V RP server will address these challenges and provide numerous benefits. It will efficiently store and manage information related to users, characters, vehicles, properties, transactions, jobs, inventories, and logs. This system will enhance data consistency, streamline reporting processes, and enable quick retrieval of important information, improving overall server management and user experience.

---

## 2. Model Descriptions

### 2.1 OLTP Database

#### Definitions & Acronyms
- **Primary Key (PK)**: Uniquely identifies records in a database table.
- **Foreign Key (FK)**: A column that references the primary key of another table.
- **Surrogate Key**: A unique identifier generated by the DBMS.
- **Data Types**:
  - **SERIAL**: Auto-incrementing integer.
  - **VARCHAR**: Variable-length string.
  - **DECIMAL**: Numeric type with fixed precision and scale.
  - **TIMESTAMP**: Stores date and time.

#### Logical Scheme

**Script: OLTP_creation.sql**

**Objects**
- **User**: Stores user information.
  - Fields: UserID (PK), Username, Password, Email, Role
- **Character**: Stores character information.
  - Fields: CharacterID (PK), UserID (FK), Name, Age, Occupation
- **Vehicle**: Stores vehicle information.
  - Fields: VehicleID (PK), CharacterID (FK), Model, LicensePlate, Status
- **Property**: Stores property information.
  - Fields: PropertyID (PK), CharacterID (FK), Address, Value
- **Transaction**: Stores transaction information.
  - Fields: TransactionID (PK), CharacterID (FK), Amount, Date, Type
- **Job**: Stores job information.
  - Fields: JobID (PK), Name, Description
- **CharacterJob**: Stores character-job assignments.
  - Fields: CharacterJobID (PK), CharacterID (FK), JobID (FK)
- **Inventory**: Stores inventory information.
  - Fields: InventoryID (PK), CharacterID (FK), ItemName, Quantity
- **Log**: Stores log information.
  - Fields: LogID (PK), UserID (FK), Action, Timestamp

### 2.2 OLAP Database

#### Definitions & Acronyms
- **Primary Key (PK)**: Uniquely identifies records in a database table.
- **Foreign Key (FK)**: A column that references the primary key of another table.
- **Surrogate Key**: A unique identifier generated by the DBMS.
- **Data Types**:
  - **SERIAL**: Auto-incrementing integer.
  - **VARCHAR**: Variable-length string.
  - **DECIMAL**: Numeric type with fixed precision and scale.
  - **TIMESTAMP**: Stores date and time.

#### Logical Scheme

**Script: OLAP_creation.sql**

**Objects**
- **DimUser**: Stores user dimension information.
  - Fields: UserID (PK), Username, Email, Role
- **DimCharacter**: Stores character dimension information.
  - Fields: CharacterID (PK), UserID (FK), Name, Age, Occupation
- **DimJob**: Stores job dimension information.
  - Fields: JobID (PK), Name, Description
- **DimItem**: Stores item dimension information.
  - Fields: ItemID (PK), ItemName
- **DimDate**: Stores date dimension information.
  - Fields: DateID (PK), Date, Day, Month, Year, Quarter, WeekOfYear

**Fact Tables**
- **FactTransactions**: Stores transaction fact information.
  - Fields: TransactionID (PK), CharacterID (FK), Amount, DateID (FK), Type
- **FactCharacterJobs**: Stores character-job fact information.
  - Fields: CharacterJobID (PK), CharacterID (FK), JobID (FK), DateID (FK)
- **FactInventory**: Stores inventory fact information.
  - Fields: InventoryID (PK), CharacterID (FK), ItemID (FK), Quantity, DateID (FK)

---

## 3. Prepare Data to Load to the OLTP Database
Data preparation involved generating CSV files for each table with realistic data for 20 rows. These files are structured to match the schema of the OLTP database tables.

---

## 4. Script for Loading Data from CSV to the OLTP Database

### Business Background
Our business requires a robust system to streamline the process of loading external data sources, validating data integrity, and inserting it into our database accurately. The `load_data_from_csv` function automates these tasks.

### Data Loading Process

**Script: OLTP_loading.sql**

The script loads data from CSV files into the OLTP database, performing necessary checks and transformations.

- **Creating Temporary Tables**: Temporary tables are created to load CSV data.
- **Loading Data**: Data is loaded into temporary tables using the COPY command.
- **Inserting Data**: Data is inserted into the main tables using INSERT operations, with LEFT JOIN to avoid duplicates.
- **Dropping Temporary Tables**: Temporary tables are dropped after data insertion.

### Business Checks
- **Check 1**: Ensure unique constraints on necessary tables.
- **Check 2**: Delete rows with invalid data.

---

## 5. Script for Loading Data from OLTP to OLAP Database

### Business Background
We require a reliable system to load data from the OLTP database to the OLAP database, verifying data integrity and ensuring accurate insertion.

### Data Loading Process

**Script: OLAP_loading.sql**

The script transfers data from the OLTP database to the OLAP database.

- **Creating FDW Server**: Create a foreign server to connect to the OLTP database.
- **Importing Schemas**: Import schemas from the OLTP database into the OLAP database.
- **Transferring Data**: Insert data into dimension and fact tables, ensuring no duplicates.

---

## 6. Power BI Report
The Power BI report visualizes key metrics from the OLAP database. Visualizations include:
- **Total Transactions**: SUM of all transaction amounts.
- **Character Job Distribution**: Distribution of jobs among characters.
- **Inventory Levels**: Inventory levels for each character.
- **Job Trends Over Time**: Job trends over different time periods.

---

## 7. How to Run the Project

### Steps to Run the Project
1. **Create Databases**: Create OLTP and OLAP databases.
2. **Clone Repository**: Clone the repository containing all necessary scripts.
3. **Run OLTP Creation Script**: Initialize OLTP database tables using `OLTP_creation.sql`.
4. **Load Data to OLTP**: Load data into OLTP database using `OLTP_loading.sql`.
5. **Run OLAP Creation Script**: Initialize OLAP database tables using `OLAP_creation.sql`.
6. **Transfer Data to OLAP**: Transfer data from OLTP to OLAP using `OLAP_loading.sql`.
7. **Run SCD Type 2 Script**: Run `OLAP_scd2.sql` to implement SCD Type 2.
8. **Power BI Report**: Open the Power BI report and import data.

---

This comprehensive approach ensures that the GTA V RP server database is well-structured, data is accurately loaded and managed, and insightful analytics are readily available through Power BI.
